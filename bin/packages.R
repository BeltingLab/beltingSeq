################################################################################
# 1. Packages for reading and processing microarray data                       #
################################################################################
if (!requireNamespace("devtools", quietly = TRUE))
  install.packages("devtools", version = "2.4.5")
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager", version = "1.30.26")
if (!requireNamespace("limma", quietly = TRUE))
  BiocManager::install("limma", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(limma))
if (!requireNamespace("affycoretools", quietly = TRUE))
    BiocManager::install("affycoretools", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(affycoretools))
if (!requireNamespace("oligo", quietly = TRUE))
    BiocManager::install("oligo", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(oligo))
if (!requireNamespace("oligoClasses", quietly = TRUE))
    BiocManager::install("oligoClasses", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(oligoClasses))
if (!requireNamespace("pd.clariom.d.human", quietly = TRUE))
    BiocManager::install("pd.clariom.d.human", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(pd.clariom.d.human))
if (!requireNamespace("clariomdhumanprobeset.db", quietly = TRUE))
    BiocManager::install("clariomdhumanprobeset.db", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(clariomdhumanprobeset.db))
if (!requireNamespace("clariomdhumantranscriptcluster.db", quietly = TRUE))
    BiocManager::install("clariomdhumantranscriptcluster.db", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(clariomdhumantranscriptcluster.db))
if (!requireNamespace("illuminaHumanv4.db", quietly = TRUE))
    BiocManager::install("illuminaHumanv4.db", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(illuminaHumanv4.db))
if (!requireNamespace("TCGAbiolinks", quietly = TRUE))
  BiocManager::install("TCGAbiolinks", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(TCGAbiolinks))


################################################################################
# 2. Utility packages                                                          #
################################################################################
if (!requireNamespace("openxlsx", quietly = TRUE))
    BiocManager::install("openxlsx", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(openxlsx))
if (!requireNamespace("dplyr", quietly = TRUE))
    BiocManager::install("dplyr", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(dplyr))
if (!requireNamespace("tibble", quietly = TRUE))
  BiocManager::install("tibble", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(tibble))
if (!requireNamespace("plyr", quietly = TRUE)) 
  BiocManager::install("plyr", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(plyr))
if (!requireNamespace("tidyr", quietly = TRUE))
  BiocManager::install("tidyr", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(tidyr))
if (!requireNamespace("stringr", quietly = TRUE))
  BiocManager::install("stringr", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(stringr))
if (!requireNamespace("DBI", quietly = TRUE))
  BiocManager::install("DBI", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(DBI))
if (!requireNamespace("MatrixGenerics", quietly = TRUE))
  BiocManager::install("MatrixGenerics", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(MatrixGenerics))

################################################################################
# 3. Visualization packages                                                    #
################################################################################
if (!requireNamespace("ggplot2", quietly = TRUE))
  BiocManager::install("ggplot2", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(ggplot2))
if (!requireNamespace("ggpubr", quietly = TRUE))
  BiocManager::install("ggpubr", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(ggpubr))
if (!requireNamespace("ggbiplot", quietly = TRUE))
    BiocManager::install("ggbiplot", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(ggbiplot))
if (!requireNamespace("ggrepel", quietly = TRUE))
    BiocManager::install("ggrepel", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(ggrepel))
if (!requireNamespace("ggnewscale"))
    BiocManager::install("ggnewscale", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(ggnewscale))
if (!requireNamespace("pheatmap", quietly = TRUE))
    BiocManager::install("pheatmap", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(pheatmap))
if (!requireNamespace("RColorBrewer", quietly = TRUE))
    BiocManager::install("RColorBrewer", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(RColorBrewer))
if (!requireNamespace("reshape2", quietly = TRUE))
    BiocManager::install("reshape2", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(reshape2))
if (!requireNamespace("viridis", quietly = TRUE))
    BiocManager::install("viridis", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(viridis))
if (!requireNamespace("VennDiagram", quietly = TRUE))
    BiocManager::install("VennDiagram", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(VennDiagram))
if (!requireNamespace("GOplot", quietly = TRUE))
    BiocManager::install("GOplot", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(GOplot))
if (!requireNamespace("ComplexUpset", quietly = TRUE))
    BiocManager::install("ComplexUpset", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(ComplexUpset))
if (!requireNamespace("conicfit", quietly = TRUE))
    BiocManager::install("conicfit", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(conicfit))
if (!requireNamespace("scatterpie", quietly = TRUE))
    BiocManager::install("scatterpie", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(scatterpie))
if (!requireNamespace("ComplexHeatmap", quietly = TRUE))
    BiocManager::install("ComplexHeatmap", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(ComplexHeatmap))
if (!requireNamespace("circlize", quietly = TRUE))
    BiocManager::install("circlize", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(circlize))
if (!requireNamespace("gridtext", quietly = TRUE))
    BiocManager::install("gridtext", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(gridtext))
if(!requireNamespace("RCy3", quietly = TRUE))
  BiocManager::install("RCy3", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(RCy3))

################################################################################
# 4. Gene set enrichment and annotation packages                               #
################################################################################
if (!requireNamespace("proxy", quietly = TRUE))
  BiocManager::install("proxy", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(proxy))
if (!requireNamespace("AnnotationDbi", quietly = TRUE))
    BiocManager::install("AnnotationDbi", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(AnnotationDbi))
if (!requireNamespace("org.Hs.eg.db", quietly = TRUE))
    BiocManager::install("org.Hs.eg.db", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(org.Hs.eg.db))
if (!requireNamespace("clusterProfiler", quietly = TRUE))
    BiocManager::install("clusterProfiler", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(clusterProfiler))
if (!requireNamespace("DOSE", quietly = TRUE))
    BiocManager::install("DOSE", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(DOSE))
if (!requireNamespace("KEGGREST", quietly = TRUE))
    BiocManager::install("KEGGREST", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(KEGGREST))
if (!requireNamespace("msigdbr", quietly = TRUE))
  devtools::install_version("msigdbr", version = "7.5.1", repos = "http://cran.us.r-project.org")
suppressPackageStartupMessages(library(msigdbr))
if (!requireNamespace("enrichplot", quietly = TRUE))
    BiocManager::install("enrichplot", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(enrichplot))
if (!requireNamespace("reactome.db", quietly = TRUE))
    BiocManager::install("reactome.db", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(reactome.db))
if (!requireNamespace("GSVA", quietly = TRUE))
  BiocManager::install("GSVA", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(GSVA))
if (!requireNamespace("rrvgo", quietly = TRUE))
  BiocManager::install("rrvgo", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(rrvgo))

################################################################################
# 5. Network analysis and visualization packages                               #
################################################################################
if (!requireNamespace("igraph", quietly = TRUE))
  BiocManager::install("igraph", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(igraph))
if (!requireNamespace("RCy3", quietly = TRUE))
  BiocManager::install("RCy3", version = "3.20", update = FALSE)
suppressPackageStartupMessages(library(RCy3))

################################################################################
# 5. Gene signature analysis                                                   #
################################################################################
if (!requireNamespace("hacksig", quietly = TRUE))
  # Package ‘hacksig’ was removed from the CRAN repository, archived on 2025-04-19, issues  
  # were not corrected despite reminders. Download from CRAN archive:
  devtools::install_version("hacksig", version = "0.1.2", repos = "http://cran.us.r-project.org")
suppressPackageStartupMessages(library(hacksig))

